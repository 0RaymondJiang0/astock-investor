import requests 
import random
#
#买入:    相当看好,觉得股价还会上涨,而且幅度不小 
#增持:    看高一线,股价有创新高的可能
#强烈推荐: 积极看涨
#推荐:    看好后市,但又不是很确定(还有一些不确定的因数) 
#优大于市: 比大市(大盘指数)表现得要优秀，比如大盘涨20%它可能能涨30% 
#
#买入>增持>强烈推荐>推荐>优于大市
# 那么按照 5，4，3，2，1 进行评分，最高5分，最低1分，
# 然后从雪球去取机构评级，最新的20条数据，最理想情况下就是都是5分，最坏是都是1分，
# 那么最高分刚好 100分，最低分 20 分。是不是可以作为机构评级反向因子。
# 如果接近100分，也许就是卖出的时候。

#当散户和机构一致看好时，也许就是卖出的时候了。：）
PX1 = [{"port":"40050","ip":"1.196.2.231"},{"port":"20291","ip":"218.73.142.81"},{"port":"24561","ip":"123.149.160.208"},{"port":"25799","ip":"1.198.194.179"},{"port":"39390","ip":"49.87.75.182"},{"port":"46629","ip":"218.85.192.85"},{"port":"45238","ip":"171.15.95.201"},{"port":"49046","ip":"1.197.58.32"},{"port":"24360","ip":"106.110.197.208"},{"port":"29717","ip":"222.85.39.78"},{"port":"33007","ip":"106.110.195.203"},{"port":"37971","ip":"222.71.89.171"},{"port":"25505","ip":"115.210.176.252"},{"port":"21397","ip":"123.163.128.154"},{"port":"24602","ip":"110.89.129.116"},{"port":"29032","ip":"59.60.175.21"},{"port":"45613","ip":"117.30.70.25"},{"port":"32881","ip":"115.239.66.149"},{"port":"40690","ip":"49.85.7.136"},{"port":"35330","ip":"125.109.195.17"},{"port":"39466","ip":"110.90.133.153"},{"port":"36077","ip":"110.85.89.172"},{"port":"38605","ip":"117.28.117.67"},{"port":"45759","ip":"27.150.85.248"},{"port":"26047","ip":"180.122.144.205"},{"port":"30634","ip":"123.162.193.248"},{"port":"38305","ip":"123.161.237.104"},{"port":"25983","ip":"183.144.209.81"},{"port":"41435","ip":"218.2.53.224"},{"port":"36432","ip":"222.85.19.167"},{"port":"34037","ip":"112.194.94.231"},{"port":"44883","ip":"112.194.89.144"},{"port":"37622","ip":"122.7.211.49"},{"port":"49173","ip":"182.39.12.250"},{"port":"48445","ip":"117.63.205.5"},{"port":"28833","ip":"101.27.21.61"},{"port":"45789","ip":"42.249.188.72"},{"port":"20723","ip":"183.163.166.175"},{"port":"43258","ip":"60.166.94.164"},{"port":"36309","ip":"61.184.214.42"},{"port":"48592","ip":"175.173.205.232"},{"port":"26804","ip":"118.79.56.237"},{"port":"37626","ip":"49.89.72.226"},{"port":"48477","ip":"117.90.31.41"},{"port":"20122","ip":"60.219.183.148"},{"port":"35500","ip":"117.66.11.58"},{"port":"37514","ip":"183.20.10.106"},{"port":"36490","ip":"112.113.155.201"},{"port":"43427","ip":"202.110.43.212"},{"port":"35223","ip":"183.45.16.2"},{"port":"31549","ip":"175.165.222.42"},{"port":"21519","ip":"117.66.87.24"},{"port":"48884","ip":"42.224.255.148"},{"port":"25214","ip":"117.66.84.130"},{"port":"28356","ip":"220.186.142.93"},{"port":"27539","ip":"101.27.20.205"},{"port":"45313","ip":"182.202.222.224"},{"port":"41652","ip":"60.166.94.224"},{"port":"21063","ip":"222.188.239.17"},{"port":"39970","ip":"101.27.21.38"},{"port":"37431","ip":"27.204.28.36"},{"port":"25343","ip":"112.194.91.226"},{"port":"26194","ip":"60.219.197.237"},{"port":"32453","ip":"49.77.210.34"},{"port":"37141","ip":"171.122.13.251"},{"port":"21897","ip":"112.195.205.209"},{"port":"33537","ip":"14.106.107.240"},{"port":"40007","ip":"118.79.9.72"},{"port":"28482","ip":"42.176.8.122"},{"port":"24375","ip":"140.250.121.202"},{"port":"22479","ip":"114.221.168.18"},{"port":"44699","ip":"175.153.22.3"},{"port":"31363","ip":"27.204.155.144"},{"port":"45197","ip":"180.118.247.134"},{"port":"42546","ip":"116.24.155.80"},{"port":"45560","ip":"113.6.44.81"},{"port":"46677","ip":"114.239.215.199"},{"port":"22032","ip":"171.80.83.173"},{"port":"28915","ip":"14.106.106.189"},{"port":"46346","ip":"125.105.170.250"},{"port":"37465","ip":"182.202.220.36"},{"port":"41078","ip":"124.167.200.250"},{"port":"38744","ip":"117.69.168.250"},{"port":"30921","ip":"125.105.168.192"},{"port":"44311","ip":"122.247.87.181"},{"port":"41266","ip":"221.231.40.110"},{"port":"29719","ip":"115.207.1.107"},{"port":"34133","ip":"114.231.4.22"},{"port":"25385","ip":"114.239.120.228"},{"port":"27374","ip":"219.156.250.216"},{"port":"29653","ip":"117.95.213.189"},{"port":"44120","ip":"115.213.98.160"},{"port":"38729","ip":"116.7.197.136"},{"port":"34642","ip":"211.93.54.185"},{"port":"29435","ip":"14.106.106.75"},{"port":"22605","ip":"106.57.22.59"},{"port":"26997","ip":"180.118.94.179"},{"port":"48296","ip":"49.67.148.48"},{"port":"40970","ip":"220.170.202.179"},{"port":"40882","ip":"182.122.40.218"}]
PX2 = [{"port":"35599","ip":"60.167.128.203"},{"port":"40729","ip":"171.8.169.197"},{"port":"33750","ip":"1.199.192.37"},{"port":"35184","ip":"123.55.94.124"},{"port":"25343","ip":"218.73.128.204"},{"port":"49619","ip":"123.163.179.51"},{"port":"35799","ip":"124.113.212.114"},{"port":"20568","ip":"49.70.17.245"},{"port":"27313","ip":"218.5.57.146"},{"port":"43388","ip":"110.90.132.69"},{"port":"47954","ip":"183.145.206.42"},{"port":"49669","ip":"183.144.206.72"},{"port":"23916","ip":"125.109.192.130"},{"port":"40726","ip":"1.197.58.221"},{"port":"47793","ip":"1.193.237.47"},{"port":"43087","ip":"223.245.230.37"},{"port":"23403","ip":"114.238.130.239"},{"port":"26470","ip":"218.2.53.183"},{"port":"40407","ip":"1.197.57.191"},{"port":"24082","ip":"27.152.108.75"},{"port":"48945","ip":"183.149.81.175"},{"port":"42340","ip":"36.25.26.125"},{"port":"23273","ip":"1.199.133.71"},{"port":"24622","ip":"49.72.32.88"},{"port":"40702","ip":"49.89.143.217"},{"port":"20576","ip":"220.162.73.238"},{"port":"30463","ip":"125.109.192.146"},{"port":"21867","ip":"123.163.161.170"},{"port":"44707","ip":"171.12.166.51"},{"port":"25133","ip":"117.95.200.167"},{"port":"47739","ip":"117.90.137.215"},{"port":"24400","ip":"182.202.223.98"},{"port":"22179","ip":"121.232.39.83"},{"port":"38358","ip":"114.102.33.241"},{"port":"42240","ip":"1.25.105.246"},{"port":"45917","ip":"115.219.72.2"},{"port":"48086","ip":"124.167.209.105"},{"port":"31119","ip":"114.237.59.51"},{"port":"38603","ip":"218.2.17.181"},{"port":"37952","ip":"112.194.81.70"},{"port":"29673","ip":"14.106.106.57"},{"port":"39428","ip":"122.245.13.202"},{"port":"22534","ip":"140.250.162.27"},{"port":"25820","ip":"125.105.169.71"},{"port":"30797","ip":"175.165.204.255"},{"port":"47107","ip":"119.5.222.111"},{"port":"25206","ip":"111.170.81.89"},{"port":"45665","ip":"118.250.97.203"},{"port":"28126","ip":"180.109.241.35"},{"port":"40157","ip":"125.118.72.241"},{"port":"25257","ip":"180.116.110.208"},{"port":"27058","ip":"112.113.152.247"},{"port":"26257","ip":"180.125.6.192"},{"port":"33409","ip":"112.194.87.106"},{"port":"21036","ip":"106.57.22.100"},{"port":"33320","ip":"122.7.227.111"},{"port":"30592","ip":"116.208.98.105"},{"port":"25438","ip":"115.219.74.103"},{"port":"40156","ip":"182.202.222.77"},{"port":"24075","ip":"180.125.155.105"},{"port":"29367","ip":"123.134.207.114"},{"port":"36585","ip":"124.230.69.19"},{"port":"49112","ip":"113.87.195.208"},{"port":"41884","ip":"117.66.84.222"},{"port":"20530","ip":"115.52.188.73"},{"port":"30948","ip":"42.203.194.23"},{"port":"48281","ip":"175.154.207.122"},{"port":"46933","ip":"124.167.201.41"},{"port":"48299","ip":"125.121.120.226"},{"port":"22911","ip":"121.236.139.48"},{"port":"45132","ip":"121.61.83.155"},{"port":"48431","ip":"106.110.203.201"},{"port":"21500","ip":"115.50.23.1"},{"port":"37626","ip":"123.8.246.253"},{"port":"47057","ip":"219.135.68.134"},{"port":"22071","ip":"115.59.213.101"},{"port":"24385","ip":"182.39.14.163"},{"port":"49051","ip":"121.61.80.204"},{"port":"24501","ip":"111.183.228.209"},{"port":"21675","ip":"125.105.183.183"},{"port":"20167","ip":"14.209.192.164"},{"port":"21026","ip":"112.113.153.162"},{"port":"26746","ip":"115.207.2.51"},{"port":"30873","ip":"222.185.66.191"},{"port":"45898","ip":"122.159.246.91"},{"port":"44025","ip":"49.89.141.246"},{"port":"36252","ip":"112.195.205.0"},{"port":"40171","ip":"27.22.76.67"},{"port":"26776","ip":"113.110.192.98"},{"port":"31261","ip":"115.202.235.29"},{"port":"37457","ip":"183.166.166.175"},{"port":"38432","ip":"49.89.111.220"},{"port":"33539","ip":"49.70.24.224"},{"port":"27587","ip":"221.207.215.156"},{"port":"27357","ip":"124.230.69.120"},{"port":"20944","ip":"112.194.93.57"},{"port":"34081","ip":"42.225.190.178"},{"port":"28533","ip":"182.122.35.139"},{"port":"24240","ip":"49.77.210.134"},{"port":"37448","ip":"115.202.246.146"}]
PX3 = [{"port":"49036","ip":"49.85.1.39"},{"port":"31371","ip":"140.224.110.218"},{"port":"20430","ip":"180.125.72.107"},{"port":"48402","ip":"171.12.180.36"},{"port":"44418","ip":"180.125.97.130"},{"port":"23319","ip":"171.12.182.172"},{"port":"20775","ip":"175.147.96.83"},{"port":"21801","ip":"171.12.164.43"},{"port":"38122","ip":"140.224.104.90"},{"port":"23561","ip":"125.109.195.123"},{"port":"47475","ip":"60.166.194.12"},{"port":"22711","ip":"49.84.223.204"},{"port":"45656","ip":"180.104.77.191"},{"port":"32750","ip":"218.72.75.159"},{"port":"47478","ip":"180.118.195.249"},{"port":"42312","ip":"180.122.150.225"},{"port":"31792","ip":"115.239.67.142"},{"port":"31170","ip":"115.221.113.207"},{"port":"28851","ip":"175.8.25.228"},{"port":"21509","ip":"27.150.117.32"},{"port":"20932","ip":"171.80.186.84"},{"port":"48599","ip":"49.85.5.86"},{"port":"29492","ip":"113.93.100.50"},{"port":"31538","ip":"60.175.199.122"},{"port":"44237","ip":"180.122.148.10"},{"port":"20900","ip":"114.231.152.77"},{"port":"42129","ip":"113.124.94.93"},{"port":"27695","ip":"121.205.72.123"},{"port":"29024","ip":"124.72.76.68"},{"port":"41943","ip":"1.196.3.81"},{"port":"32536","ip":"112.194.95.201"},{"port":"26370","ip":"183.20.11.113"},{"port":"29726","ip":"114.236.234.243"},{"port":"29647","ip":"221.199.195.152"},{"port":"39517","ip":"113.121.189.183"},{"port":"47245","ip":"117.68.243.233"},{"port":"45568","ip":"219.156.255.24"},{"port":"31391","ip":"125.105.133.194"},{"port":"36597","ip":"106.57.23.209"},{"port":"25007","ip":"125.105.91.36"},{"port":"25470","ip":"110.18.142.165"},{"port":"30780","ip":"124.167.101.167"},{"port":"38554","ip":"114.221.174.88"},{"port":"27373","ip":"49.83.205.234"},{"port":"32677","ip":"124.230.2.44"},{"port":"49331","ip":"125.118.247.186"},{"port":"38165","ip":"180.121.115.116"},{"port":"42753","ip":"106.57.23.219"},{"port":"33717","ip":"112.113.152.163"},{"port":"34276","ip":"220.170.202.36"},{"port":"37713","ip":"175.153.22.19"},{"port":"21145","ip":"183.188.209.168"},{"port":"45315","ip":"114.104.146.17"},{"port":"36317","ip":"121.235.230.124"},{"port":"38596","ip":"182.126.174.254"},{"port":"29166","ip":"114.238.167.19"},{"port":"41527","ip":"219.157.35.232"},{"port":"27153","ip":"116.208.96.197"},{"port":"46502","ip":"60.219.183.172"},{"port":"29606","ip":"118.79.9.40"},{"port":"26312","ip":"112.194.216.27"},{"port":"30835","ip":"112.113.154.240"},{"port":"31062","ip":"27.22.76.67"},{"port":"47684","ip":"183.32.143.23"},{"port":"48226","ip":"114.227.98.83"},{"port":"36052","ip":"123.12.225.36"},{"port":"46847","ip":"123.8.227.114"},{"port":"48611","ip":"112.113.156.159"},{"port":"48383","ip":"113.121.172.18"},{"port":"41471","ip":"122.157.144.117"},{"port":"45463","ip":"114.239.122.183"},{"port":"42414","ip":"115.203.162.49"},{"port":"40183","ip":"110.19.189.14"},{"port":"26383","ip":"182.202.223.149"},{"port":"33893","ip":"171.125.14.126"},{"port":"39836","ip":"125.121.120.206"},{"port":"43896","ip":"113.121.175.123"},{"port":"25205","ip":"113.240.217.180"},{"port":"23498","ip":"125.105.176.4"},{"port":"40099","ip":"175.154.207.122"},{"port":"29762","ip":"115.203.206.196"},{"port":"41069","ip":"183.163.164.191"},{"port":"43241","ip":"180.115.218.161"},{"port":"21949","ip":"175.154.201.251"},{"port":"25830","ip":"115.219.72.95"},{"port":"21288","ip":"1.24.214.250"},{"port":"42597","ip":"183.32.143.92"},{"port":"31808","ip":"180.125.110.136"},{"port":"34617","ip":"182.202.220.237"},{"port":"30278","ip":"113.76.155.230"},{"port":"40238","ip":"60.214.162.219"},{"port":"39731","ip":"220.165.17.146"},{"port":"34535","ip":"180.118.134.44"},{"port":"31856","ip":"180.116.110.103"},{"port":"31511","ip":"220.165.30.229"},{"port":"45411","ip":"27.204.6.97"},{"port":"29352","ip":"124.167.211.187"},{"port":"44181","ip":"114.227.158.214"},{"port":"35077","ip":"125.105.177.137"},{"port":"46200","ip":"60.31.89.154"}]
PX4 = [{"port":"40951","ip":"171.80.187.11"},{"port":"24799","ip":"171.12.138.150"},{"port":"23258","ip":"171.80.160.18"},{"port":"42553","ip":"117.95.83.41"},{"port":"45092","ip":"115.209.8.180"},{"port":"35155","ip":"222.85.39.156"},{"port":"21663","ip":"119.116.79.187"},{"port":"29156","ip":"115.210.177.147"},{"port":"48826","ip":"120.43.67.188"},{"port":"36450","ip":"27.156.151.33"},{"port":"34789","ip":"114.230.99.23"},{"port":"20425","ip":"171.13.37.152"},{"port":"45953","ip":"180.122.146.49"},{"port":"23970","ip":"117.31.144.132"},{"port":"43743","ip":"171.80.157.171"},{"port":"38267","ip":"60.184.195.247"},{"port":"33621","ip":"114.230.122.74"},{"port":"22806","ip":"60.175.212.150"},{"port":"34097","ip":"49.85.7.235"},{"port":"28573","ip":"223.247.246.50"},{"port":"34408","ip":"171.80.159.124"},{"port":"38831","ip":"125.109.192.3"},{"port":"44094","ip":"117.95.55.212"},{"port":"34753","ip":"106.46.124.224"},{"port":"24361","ip":"171.13.25.243"},{"port":"34397","ip":"106.42.21.97"},{"port":"20901","ip":"125.109.198.67"},{"port":"33415","ip":"182.34.37.180"},{"port":"49312","ip":"123.55.94.163"},{"port":"37930","ip":"180.112.20.98"},{"port":"27809","ip":"124.230.65.91"},{"port":"45463","ip":"122.157.183.160"},{"port":"41252","ip":"175.10.149.227"},{"port":"32651","ip":"42.57.170.12"},{"port":"26980","ip":"101.27.22.74"},{"port":"46868","ip":"42.178.230.120"},{"port":"37558","ip":"113.0.23.151"},{"port":"40410","ip":"111.170.104.210"},{"port":"38501","ip":"114.226.91.197"},{"port":"47589","ip":"60.179.249.220"},{"port":"44597","ip":"183.33.214.90"},{"port":"44531","ip":"114.227.53.27"},{"port":"33539","ip":"114.102.47.14"},{"port":"24598","ip":"115.219.78.182"},{"port":"36089","ip":"118.79.209.251"},{"port":"49798","ip":"182.202.220.177"},{"port":"45075","ip":"123.134.109.16"},{"port":"29918","ip":"117.82.223.51"},{"port":"35138","ip":"180.121.115.13"},{"port":"42508","ip":"220.165.29.195"},{"port":"25742","ip":"125.118.73.51"},{"port":"39490","ip":"114.239.90.71"},{"port":"38485","ip":"125.118.240.130"},{"port":"30139","ip":"122.245.12.70"},{"port":"32465","ip":"49.73.32.185"},{"port":"42415","ip":"115.219.72.153"},{"port":"26985","ip":"117.66.90.78"},{"port":"44673","ip":"119.5.218.102"},{"port":"34386","ip":"121.231.221.226"},{"port":"28813","ip":"106.111.41.36"},{"port":"33174","ip":"114.221.169.104"},{"port":"35344","ip":"124.163.74.78"},{"port":"22771","ip":"144.0.102.141"},{"port":"32130","ip":"183.20.8.23"},{"port":"41533","ip":"125.126.170.252"},{"port":"29555","ip":"112.113.154.163"},{"port":"30830","ip":"121.226.45.195"},{"port":"25161","ip":"123.134.125.134"},{"port":"39630","ip":"182.244.168.178"},{"port":"42314","ip":"171.122.155.12"},{"port":"40160","ip":"1.25.145.217"},{"port":"30289","ip":"222.142.156.156"},{"port":"48642","ip":"101.27.20.14"},{"port":"36109","ip":"60.166.95.98"},{"port":"23180","ip":"123.11.92.206"},{"port":"43879","ip":"113.121.176.55"},{"port":"31421","ip":"60.31.89.86"},{"port":"31922","ip":"1.25.147.172"},{"port":"44027","ip":"211.93.54.29"},{"port":"37185","ip":"220.165.17.64"},{"port":"33580","ip":"114.239.89.36"},{"port":"40054","ip":"125.105.161.153"},{"port":"40285","ip":"180.118.92.62"},{"port":"25037","ip":"117.95.40.48"},{"port":"30310","ip":"110.18.136.49"},{"port":"21925","ip":"140.250.90.61"},{"port":"33739","ip":"183.20.11.28"},{"port":"38705","ip":"171.122.153.128"},{"port":"24283","ip":"183.166.229.191"},{"port":"30442","ip":"112.113.154.20"},{"port":"45835","ip":"221.14.223.151"},{"port":"29303","ip":"218.2.17.74"},{"port":"35159","ip":"125.105.163.202"},{"port":"41171","ip":"113.110.193.206"},{"port":"24308","ip":"121.234.65.16"},{"port":"35371","ip":"222.188.180.183"},{"port":"26390","ip":"27.29.148.89"},{"port":"37208","ip":"114.238.167.113"},{"port":"20656","ip":"116.115.211.19"},{"port":"49918","ip":"114.231.4.254"}]
PX5 = [{"port":"44575","ip":"121.12.22.98"},{"port":"27413","ip":"36.99.159.35"},{"port":"44773","ip":"171.13.37.245"},{"port":"35237","ip":"60.175.198.27"},{"port":"41074","ip":"114.230.123.155"},{"port":"21924","ip":"1.197.178.177"},{"port":"20485","ip":"123.163.179.107"},{"port":"23051","ip":"220.162.20.180"},{"port":"41992","ip":"115.221.124.171"},{"port":"46108","ip":"59.58.209.139"},{"port":"25834","ip":"115.204.39.158"},{"port":"26567","ip":"123.53.86.22"},{"port":"45359","ip":"114.230.122.207"},{"port":"29756","ip":"117.95.71.19"},{"port":"31195","ip":"27.156.145.174"},{"port":"29957","ip":"115.210.71.233"},{"port":"32161","ip":"114.230.106.206"},{"port":"33408","ip":"182.42.46.73"},{"port":"40436","ip":"183.144.194.5"},{"port":"42657","ip":"180.122.147.2"},{"port":"44951","ip":"218.73.136.105"},{"port":"38310","ip":"58.209.115.225"},{"port":"44436","ip":"1.198.196.17"},{"port":"39509","ip":"123.163.133.49"},{"port":"40547","ip":"115.202.233.103"},{"port":"23416","ip":"59.56.225.53"},{"port":"48165","ip":"115.210.180.226"},{"port":"48497","ip":"115.203.186.201"},{"port":"22161","ip":"115.209.9.61"},{"port":"41715","ip":"36.25.111.235"},{"port":"39644","ip":"49.81.80.38"},{"port":"49292","ip":"180.126.112.63"},{"port":"49350","ip":"182.84.78.235"},{"port":"27938","ip":"111.170.105.155"},{"port":"40478","ip":"182.84.78.109"},{"port":"22075","ip":"49.67.149.250"},{"port":"40294","ip":"222.188.182.189"},{"port":"25105","ip":"117.68.145.45"},{"port":"24628","ip":"183.166.213.200"},{"port":"28097","ip":"218.10.4.26"},{"port":"32296","ip":"180.118.92.246"},{"port":"37767","ip":"60.179.233.161"},{"port":"43207","ip":"221.227.74.211"},{"port":"23872","ip":"182.202.222.231"},{"port":"23311","ip":"115.203.198.42"},{"port":"39107","ip":"117.67.140.78"},{"port":"46303","ip":"60.172.113.182"},{"port":"24882","ip":"115.221.15.39"},{"port":"26445","ip":"182.202.13.110"},{"port":"33876","ip":"175.0.49.142"},{"port":"21059","ip":"115.49.125.55"},{"port":"20973","ip":"122.157.177.224"},{"port":"25904","ip":"114.102.39.100"},{"port":"23201","ip":"114.105.130.75"},{"port":"49917","ip":"182.126.22.118"},{"port":"32952","ip":"117.67.140.223"},{"port":"38890","ip":"183.166.214.176"},{"port":"43061","ip":"122.245.135.243"},{"port":"44237","ip":"112.194.70.145"},{"port":"24814","ip":"175.154.201.242"},{"port":"42445","ip":"220.165.29.123"},{"port":"48800","ip":"106.57.23.39"},{"port":"31726","ip":"221.235.211.202"},{"port":"35273","ip":"125.105.177.30"},{"port":"35956","ip":"220.186.185.29"},{"port":"40165","ip":"180.110.151.184"},{"port":"34304","ip":"114.237.53.191"},{"port":"29879","ip":"121.224.93.168"},{"port":"49255","ip":"112.194.64.80"},{"port":"43309","ip":"221.227.72.124"},{"port":"30069","ip":"114.227.50.65"},{"port":"26836","ip":"113.121.160.229"},{"port":"44557","ip":"117.68.243.27"},{"port":"21133","ip":"175.10.149.40"},{"port":"34324","ip":"115.203.221.211"},{"port":"39219","ip":"125.86.166.94"},{"port":"23373","ip":"60.219.217.242"},{"port":"45378","ip":"60.179.232.110"},{"port":"32514","ip":"118.79.56.101"},{"port":"23830","ip":"171.122.38.206"},{"port":"22827","ip":"114.227.59.201"},{"port":"21081","ip":"124.230.71.202"},{"port":"21318","ip":"123.15.15.100"},{"port":"23058","ip":"218.8.132.76"},{"port":"47641","ip":"42.232.225.207"},{"port":"31203","ip":"112.113.156.197"},{"port":"46477","ip":"115.52.189.82"},{"port":"47970","ip":"171.122.0.169"},{"port":"45158","ip":"219.156.167.17"},{"port":"29912","ip":"121.235.230.208"},{"port":"39214","ip":"106.57.7.133"},{"port":"25044","ip":"175.173.198.136"},{"port":"23042","ip":"218.24.58.138"},{"port":"25530","ip":"183.20.11.185"},{"port":"29020","ip":"113.87.192.120"},{"port":"42980","ip":"116.208.98.107"},{"port":"24894","ip":"106.110.4.26"},{"port":"29633","ip":"114.226.93.102"},{"port":"33650","ip":"110.18.138.41"},{"port":"26433","ip":"183.32.218.206"}]
# PX6 = [{"port":"47290","ip":"183.148.79.196"},{"port":"44552","ip":"113.93.101.199"},{"port":"33744","ip":"121.206.88.113"},{"port":"27731","ip":"223.245.250.243"},{"port":"46306","ip":"36.27.141.234"},{"port":"44447","ip":"114.238.130.134"},{"port":"27961","ip":"120.33.247.91"},{"port":"46949","ip":"60.182.186.248"},{"port":"44349","ip":"171.15.91.187"},{"port":"26387","ip":"144.255.49.86"},{"port":"28301","ip":"60.169.126.147"},{"port":"48369","ip":"180.122.149.5"},{"port":"21730","ip":"110.86.100.97"},{"port":"46094","ip":"180.122.145.125"},{"port":"25708","ip":"1.198.89.147"},{"port":"42111","ip":"60.175.213.54"},{"port":"41742","ip":"123.160.51.51"},{"port":"30152","ip":"1.198.242.164"},{"port":"35076","ip":"49.84.217.67"},{"port":"44234","ip":"117.95.103.146"},{"port":"25496","ip":"222.89.74.143"},{"port":"48404","ip":"27.152.144.16"},{"port":"23213","ip":"36.25.24.140"},{"port":"31463","ip":"183.145.206.181"},{"port":"31602","ip":"180.122.144.112"},{"port":"30410","ip":"125.78.15.208"},{"port":"21319","ip":"116.27.247.154"},{"port":"49449","ip":"1.196.131.35"},{"port":"25383","ip":"114.230.98.96"},{"port":"30404","ip":"114.230.123.201"},{"port":"46694","ip":"114.107.5.70"},{"port":"26353","ip":"118.79.89.240"},{"port":"39695","ip":"115.213.101.108"},{"port":"49578","ip":"112.113.154.15"},{"port":"22747","ip":"114.102.13.253"},{"port":"22400","ip":"122.157.180.255"},{"port":"27459","ip":"183.20.9.176"},{"port":"33297","ip":"183.188.209.91"},{"port":"47718","ip":"182.202.222.215"},{"port":"43099","ip":"219.157.38.196"},{"port":"22319","ip":"117.90.137.152"},{"port":"35657","ip":"101.27.21.88"},{"port":"42116","ip":"220.186.182.13"},{"port":"43229","ip":"182.113.134.172"},{"port":"25558","ip":"101.27.22.40"},{"port":"30587","ip":"113.0.206.202"},{"port":"25326","ip":"117.69.138.167"},{"port":"23945","ip":"61.53.157.99"},{"port":"28236","ip":"117.67.141.165"},{"port":"35296","ip":"222.188.182.105"},{"port":"22356","ip":"59.33.117.165"},{"port":"37448","ip":"140.250.159.179"},{"port":"38024","ip":"117.63.11.24"},{"port":"26253","ip":"121.234.71.211"},{"port":"24087","ip":"182.202.222.150"},{"port":"36487","ip":"116.208.101.149"},{"port":"20646","ip":"112.113.152.167"},{"port":"36042","ip":"115.54.213.220"},{"port":"48994","ip":"182.244.169.2"},{"port":"38501","ip":"113.240.219.185"},{"port":"41411","ip":"180.107.46.20"},{"port":"42598","ip":"1.24.212.161"},{"port":"39259","ip":"112.194.94.130"},{"port":"23931","ip":"114.102.38.230"},{"port":"25292","ip":"112.113.155.74"},{"port":"30088","ip":"1.29.109.80"},{"port":"40684","ip":"115.219.75.56"},{"port":"49514","ip":"114.221.170.113"},{"port":"42878","ip":"175.165.208.148"},{"port":"36040","ip":"123.11.219.34"},{"port":"23809","ip":"180.119.43.53"},{"port":"29409","ip":"115.51.122.17"},{"port":"20460","ip":"1.58.180.9"},{"port":"40442","ip":"182.244.164.40"},{"port":"45227","ip":"123.134.239.136"},{"port":"20675","ip":"180.120.252.140"},{"port":"37463","ip":"182.38.104.117"},{"port":"21760","ip":"140.250.121.46"},{"port":"30766","ip":"171.122.20.31"},{"port":"27825","ip":"121.230.208.212"},{"port":"44949","ip":"117.92.68.82"},{"port":"43903","ip":"49.89.109.238"},{"port":"27646","ip":"221.230.216.25"},{"port":"39084","ip":"1.30.190.216"},{"port":"41651","ip":"14.116.13.194"},{"port":"42948","ip":"27.29.156.155"},{"port":"31700","ip":"101.27.21.249"},{"port":"26804","ip":"118.79.56.18"},{"port":"43656","ip":"125.105.132.116"},{"port":"48134","ip":"218.93.61.53"},{"port":"43688","ip":"60.168.22.30"},{"port":"32831","ip":"183.188.243.187"},{"port":"39849","ip":"117.60.2.206"},{"port":"39824","ip":"117.85.48.100"},{"port":"41762","ip":"114.221.170.218"},{"port":"37358","ip":"49.70.92.239"},{"port":"26960","ip":"182.202.220.98"},{"port":"21809","ip":"125.105.2.154"},{"port":"41111","ip":"220.191.12.56"},{"port":"40124","ip":"49.73.49.188"}]

PX = PX1 + PX2 + PX3 + PX4 + PX5 

class XueqiuService(object):
  def __init__(self, code = None):
    self.s = requests.session()
    self.code = self.__toXueqiuUrlcode(code)

    proxy = self.__get_proxy()
    if proxy != None:
      self.proxies={"http": "http://{}".format(proxy)}
    else:
      self.proxies = None

    print('proxy: %s' % self.proxies)

    self.headers = {'User-Agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/67.0.3396.87 Safari/537.36',
                    'Host': 'xueqiu.com', 'Referer': 'https://xueqiu.com/', 'X-Requested-With': 'XMLHttpRequest'}

    self.s.head('https://xueqiu.com', headers = self.headers, proxies = self.proxies)

  #获取关注数量
  def getFollowCount(self):
    res = self.s.get('https://xueqiu.com/recommend/pofriends.json?type=1&code=%s&start=0&count=0' % self.code, headers = self.headers, proxies = self.proxies)
    return res.json()['totalcount']

  #获取用户讨论数量
  def getDiscussCount(self):
    res = self.s.get('https://xueqiu.com/statuses/search.json?count=1&comment=0&symbol=%s&hl=0&source=user&sort=time&page=1&q=' % self.code, headers = self.headers, proxies = self.proxies)
    # print(res.text)
    return res.json()['count']

  #获取股票详情
  def getQuoteDetail(self):
    res = self.s.get('https://stock.xueqiu.com/v5/stock/quote.json?symbol=%s&extend=detail' % self.code, headers = self.headers, proxies = self.proxies)
    return res.json()['data']['quote']

  #获取雪球评论,列表在 list 
  #source = all, user
  def getComments(self, source = 'all', page = 1):
    res = self.s.get('https://xueqiu.com/statuses/search.json?count=10&comment=0&symbol=%s&hl=0&source=%s&sort=time&page=%s&q=' % (self.code, source, page), headers = self.headers, proxies = self.proxies)
    return res.json()

  #获取其他信息
  #source = 投资者关系，交易，新闻，公共，研报
  def getOtherInfo(self, count = 10, source = '研报', page =1):
    res = self.s.get('https://xueqiu.com/statuses/stock_timeline.json?symbol_id=%s&count=%s&source=%s&page=%s' % (self.code, count, source, page), headers = self.headers, proxies = self.proxies)
    return res.json()

  #将股票代理转换成雪球可识别的代码
  def __toXueqiuUrlcode(self, code):
    if len(code) > 5:
      firstChar = code[:1]
      if firstChar == '5' or firstChar == '6' or firstChar == '9':
        return 'SH%s' % code 
      else:
        return 'SZ%s' % code 

    else:
      return code

  def __get_proxy(self):
    secure_random = random.SystemRandom()
    item = secure_random.choice(PX)
    return "%s:%s" % (item['ip'], item['port'])
